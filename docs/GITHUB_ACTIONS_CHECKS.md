# GitHub Actions æ£€æŸ¥é¡¹è¯´æ˜

## ğŸ“‹ 5 ä¸ªæ£€æŸ¥é¡¹å¯¹åº”å…³ç³»

å½“ä½  push ä»£ç åˆ° GitHub æ—¶ï¼Œä¼šçœ‹åˆ° 5 ä¸ªæ£€æŸ¥é¡¹ï¼Œå®ƒä»¬åˆ†åˆ«å¯¹åº”ä»¥ä¸‹é…ç½®ï¼š

### 1. âœ… Deploy to Vercel / Check for Migration Changes (push)
- **çŠ¶æ€**ï¼šæˆåŠŸï¼ˆ6ç§’ï¼‰
- **å¯¹åº”é…ç½®**ï¼š`.github/workflows/deploy-vercel.yml` ä¸­çš„ `check-migrations` job
- **ä½œç”¨**ï¼šæ£€æŸ¥ `supabase/migrations/` ç›®å½•æ˜¯å¦æœ‰æ–‡ä»¶å˜åŒ–
- **æ–‡ä»¶ä½ç½®**ï¼šç¬¬ 16-37 è¡Œ

```yaml
check-migrations:
  name: Check for Migration Changes
  # æ£€æŸ¥æ˜¯å¦æœ‰è¿ç§»æ–‡ä»¶å˜åŒ–
```

### 2. â­ï¸ Deploy to Vercel / Run Supabase Migrations (push)
- **çŠ¶æ€**ï¼šè·³è¿‡ï¼ˆSkippedï¼‰
- **å¯¹åº”é…ç½®**ï¼š`.github/workflows/deploy-vercel.yml` ä¸­çš„ `migrate-database` job
- **ä½œç”¨**ï¼šæ‰§è¡Œæ•°æ®åº“è¿ç§»ï¼ˆä»…åœ¨æ£€æµ‹åˆ°è¿ç§»æ–‡ä»¶å˜åŒ–æ—¶æ‰§è¡Œï¼‰
- **æ–‡ä»¶ä½ç½®**ï¼šç¬¬ 40-75 è¡Œ
- **ä¸ºä»€ä¹ˆè·³è¿‡**ï¼šå› ä¸ºæ²¡æœ‰æ£€æµ‹åˆ°è¿ç§»æ–‡ä»¶å˜åŒ–ï¼ˆè¿™æ˜¯æ­£å¸¸çš„ä¼˜åŒ–è¡Œä¸ºï¼‰

```yaml
migrate-database:
  name: Run Supabase Migrations
  if: needs.check-migrations.outputs.has-migrations == 'true'
  # åªåœ¨æœ‰è¿ç§»æ–‡ä»¶å˜åŒ–æ—¶æ‰§è¡Œ
```

### 3. ğŸ”„ Deploy to Vercel / Deploy to Vercel (push)
- **çŠ¶æ€**ï¼šè¿›è¡Œä¸­ï¼ˆIn progressï¼‰
- **å¯¹åº”é…ç½®**ï¼š`.github/workflows/deploy-vercel.yml` ä¸­çš„ `deploy` job
- **ä½œç”¨**ï¼šæ„å»ºé¡¹ç›®å¹¶éƒ¨ç½²åˆ° Vercel
- **æ–‡ä»¶ä½ç½®**ï¼šç¬¬ 78-127 è¡Œ
- **æ‰§è¡Œæ­¥éª¤**ï¼š
  1. å®‰è£…ä¾èµ–
  2. è¿è¡Œ linter
  3. æ„å»ºé¡¹ç›®
  4. ä½¿ç”¨ Vercel CLI éƒ¨ç½²

```yaml
deploy:
  name: Deploy to Vercel
  needs: [check-migrations, migrate-database]
  # ç­‰å¾…è¿ç§»æ£€æŸ¥å®Œæˆåå†éƒ¨ç½²
```

### 4. â³ Vercel
- **çŠ¶æ€**ï¼šå¾…å¤„ç†ï¼ˆPendingï¼‰
- **å¯¹åº”é…ç½®**ï¼š**Vercel GitHub Integration**ï¼ˆè‡ªåŠ¨æ·»åŠ ï¼‰
- **ä½œç”¨**ï¼šVercel å¹³å°è‡ªå·±çš„éƒ¨ç½²æ£€æŸ¥
- **æ¥æº**ï¼šå¦‚æœä½ åœ¨ Vercel Dashboard ä¸­è¿æ¥äº† GitHub ä»“åº“ï¼ŒVercel ä¼šè‡ªåŠ¨æ·»åŠ è¿™ä¸ªæ£€æŸ¥
- **è¯´æ˜**ï¼šè¿™æ˜¯ Vercel çš„é›†æˆæ£€æŸ¥ï¼Œä¸ GitHub Actions çš„éƒ¨ç½²ä»»åŠ¡å¹¶è¡Œè¿è¡Œ

### 5. ğŸ”„ Playwright Tests / test (push)
- **çŠ¶æ€**ï¼šè¿›è¡Œä¸­ï¼ˆIn progressï¼‰
- **å¯¹åº”é…ç½®**ï¼š`.github/workflows/playwright.yml` ä¸­çš„ `test` job
- **ä½œç”¨**ï¼šè¿è¡Œç«¯åˆ°ç«¯æµ‹è¯•
- **æ–‡ä»¶ä½ç½®**ï¼š`.github/workflows/playwright.yml` ç¬¬ 8-42 è¡Œ
- **æ‰§è¡Œæ­¥éª¤**ï¼š
  1. Seed æµ‹è¯•ç”¨æˆ·
  2. æ¸…ç†æµ‹è¯•æ•°æ®
  3. å®‰è£… Playwright æµè§ˆå™¨
  4. è¿è¡Œæµ‹è¯•

```yaml
test:
  name: test
  # è¿è¡Œ Playwright E2E æµ‹è¯•
```

---

## ğŸ“Š å·¥ä½œæµæ–‡ä»¶æ€»ç»“

### å·¥ä½œæµæ–‡ä»¶ 1ï¼š`deploy-vercel.yml`
åŒ…å« **3 ä¸ª jobs**ï¼š
1. `check-migrations` - æ£€æŸ¥è¿ç§»æ–‡ä»¶å˜åŒ–
2. `migrate-database` - æ‰§è¡Œæ•°æ®åº“è¿ç§»ï¼ˆæ¡ä»¶æ‰§è¡Œï¼‰
3. `deploy` - éƒ¨ç½²åˆ° Vercel

### å·¥ä½œæµæ–‡ä»¶ 2ï¼š`playwright.yml`
åŒ…å« **1 ä¸ª job**ï¼š
1. `test` - è¿è¡Œ Playwright æµ‹è¯•

### Vercel Integration
è‡ªåŠ¨æ·»åŠ  **1 ä¸ªæ£€æŸ¥**ï¼š
1. `Vercel` - Vercel å¹³å°çš„éƒ¨ç½²æ£€æŸ¥

**æ€»è®¡ï¼š3 + 1 + 1 = 5 ä¸ªæ£€æŸ¥é¡¹**

---

## ğŸ”„ æ‰§è¡Œé¡ºåº

```
Push to GitHub
    â†“
å¹¶è¡Œè§¦å‘ä¸¤ä¸ªå·¥ä½œæµï¼š
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  deploy-vercel.yml      â”‚  playwright.yml         â”‚
â”‚                         â”‚                         â”‚
â”‚  1. check-migrations    â”‚  1. test                â”‚
â”‚     (6ç§’) âœ…             â”‚     (è¿›è¡Œä¸­) ğŸ”„          â”‚
â”‚                         â”‚                         â”‚
â”‚  2. migrate-database    â”‚                         â”‚
â”‚     (è·³è¿‡) â­ï¸            â”‚                         â”‚
â”‚                         â”‚                         â”‚
â”‚  3. deploy              â”‚                         â”‚
â”‚     (è¿›è¡Œä¸­) ğŸ”„          â”‚                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
Vercel Integration
    â†“
  Vercel æ£€æŸ¥
    (å¾…å¤„ç†) â³
```

---

## ğŸ“ è¯¦ç»†è¯´æ˜

### ä¸ºä»€ä¹ˆæœ‰ 5 ä¸ªæ£€æŸ¥ï¼Ÿ

1. **3 ä¸ªæ¥è‡ª `deploy-vercel.yml`**ï¼š
   - è¿ç§»æ£€æŸ¥ï¼ˆå¿…é¡»æ‰§è¡Œï¼‰
   - è¿ç§»æ‰§è¡Œï¼ˆæ¡ä»¶æ‰§è¡Œï¼Œè¿™æ¬¡è¢«è·³è¿‡ï¼‰
   - Vercel éƒ¨ç½²ï¼ˆå¿…é¡»æ‰§è¡Œï¼‰

2. **1 ä¸ªæ¥è‡ª `playwright.yml`**ï¼š
   - Playwright æµ‹è¯•ï¼ˆå¿…é¡»æ‰§è¡Œï¼‰

3. **1 ä¸ªæ¥è‡ª Vercel Integration**ï¼š
   - Vercel å¹³å°çš„è‡ªåŠ¨æ£€æŸ¥ï¼ˆå¦‚æœä½ è¿æ¥äº† GitHubï¼‰

### ä¸ºä»€ä¹ˆè¿ç§»ä»»åŠ¡è¢«è·³è¿‡ï¼Ÿ

è¿™æ˜¯**æ­£å¸¸çš„ä¼˜åŒ–è¡Œä¸º**ï¼š
- æ£€æŸ¥ä»»åŠ¡æ£€æµ‹åˆ°æ²¡æœ‰è¿ç§»æ–‡ä»¶å˜åŒ–
- å› æ­¤è·³è¿‡è¿ç§»æ‰§è¡Œä»»åŠ¡
- èŠ‚çœ CI æ—¶é—´ï¼ˆçº¦ 30-60 ç§’ï¼‰

### ä¸ºä»€ä¹ˆæœ‰ä¸¤ä¸ª Vercel ç›¸å…³çš„æ£€æŸ¥ï¼Ÿ

1. **Deploy to Vercel / Deploy to Vercel**ï¼š
   - æ¥è‡ª GitHub Actions å·¥ä½œæµ
   - ä½¿ç”¨ Vercel CLI æ‰‹åŠ¨éƒ¨ç½²
   - å®Œå…¨å¯æ§çš„éƒ¨ç½²æµç¨‹

2. **Vercel**ï¼š
   - æ¥è‡ª Vercel GitHub Integration
   - Vercel å¹³å°çš„è‡ªåŠ¨éƒ¨ç½²æ£€æŸ¥
   - å¦‚æœä½ åœ¨ Vercel Dashboard ä¸­è¿æ¥äº†ä»“åº“ï¼Œä¼šè‡ªåŠ¨æ·»åŠ 

**å»ºè®®**ï¼šå¦‚æœä½ ä½¿ç”¨ GitHub Actions éƒ¨ç½²ï¼Œå¯ä»¥ç¦ç”¨ Vercel Integration çš„è‡ªåŠ¨éƒ¨ç½²ï¼Œé¿å…é‡å¤ã€‚

---

## ğŸ¯ å¦‚ä½•ç®¡ç†è¿™äº›æ£€æŸ¥

### é€‰é¡¹ 1ï¼šåªä½¿ç”¨ GitHub Actionsï¼ˆæ¨èï¼‰

å¦‚æœä½ ä½¿ç”¨ GitHub Actions éƒ¨ç½²ï¼Œå¯ä»¥ï¼š
1. åœ¨ Vercel Dashboard ä¸­ç¦ç”¨è‡ªåŠ¨éƒ¨ç½²
2. åªä¿ç•™ GitHub Actions çš„éƒ¨ç½²ä»»åŠ¡

**ä¼˜ç‚¹**ï¼š
- ç»Ÿä¸€çš„éƒ¨ç½²æµç¨‹
- æ›´å¥½çš„æ§åˆ¶å’Œå¯è§æ€§
- å¯ä»¥è‡ªå®šä¹‰éƒ¨ç½²æ­¥éª¤

### é€‰é¡¹ 2ï¼šåªä½¿ç”¨ Vercel Integration

å¦‚æœä½ ä½¿ç”¨ Vercel Integrationï¼š
1. åˆ é™¤æˆ–ç¦ç”¨ `deploy-vercel.yml` å·¥ä½œæµ
2. è®© Vercel è‡ªåŠ¨å¤„ç†éƒ¨ç½²

**ä¼˜ç‚¹**ï¼š
- é…ç½®æ›´ç®€å•
- Vercel è‡ªåŠ¨å¤„ç†ä¸€åˆ‡

### é€‰é¡¹ 3ï¼šåŒæ—¶ä½¿ç”¨ï¼ˆå½“å‰çŠ¶æ€ï¼‰

ä¸¤ä¸ªéƒ¨ç½²æ–¹å¼å¹¶è¡Œè¿è¡Œï¼š
- GitHub Actions æ‰‹åŠ¨éƒ¨ç½²
- Vercel Integration è‡ªåŠ¨éƒ¨ç½²

**æ³¨æ„**ï¼šè¿™å¯èƒ½å¯¼è‡´é‡å¤éƒ¨ç½²ï¼Œå»ºè®®é€‰æ‹©ä¸€ç§æ–¹å¼ã€‚

---

## âœ… æ£€æŸ¥æ¸…å•

å½“å‰é…ç½®ä¸‹ï¼Œæ¯æ¬¡ push ä¼šè§¦å‘ï¼š

- [x] è¿ç§»æ–‡ä»¶æ£€æŸ¥ï¼ˆ`check-migrations`ï¼‰
- [x] æ•°æ®åº“è¿ç§»ï¼ˆ`migrate-database`ï¼Œæ¡ä»¶æ‰§è¡Œï¼‰
- [x] Vercel éƒ¨ç½²ï¼ˆ`deploy`ï¼‰
- [x] Playwright æµ‹è¯•ï¼ˆ`test`ï¼‰
- [x] Vercel Integration æ£€æŸ¥ï¼ˆå¦‚æœå·²è¿æ¥ï¼‰

---

## ğŸ“š ç›¸å…³æ–‡ä»¶

- `.github/workflows/deploy-vercel.yml` - Vercel éƒ¨ç½²å·¥ä½œæµ
- `.github/workflows/playwright.yml` - Playwright æµ‹è¯•å·¥ä½œæµ
- Vercel Dashboard - Vercel Integration è®¾ç½®

---

## ğŸ”§ å¦‚ä½•ç¦ç”¨ Vercel Integration æ£€æŸ¥

å¦‚æœä½ æƒ³ç¦ç”¨ Vercel çš„è‡ªåŠ¨æ£€æŸ¥ï¼š

1. è®¿é—® [Vercel Dashboard](https://vercel.com/dashboard)
2. é€‰æ‹©ä½ çš„é¡¹ç›®
3. è¿›å…¥ **Settings** â†’ **Git**
4. æ‰¾åˆ° **GitHub Integration**
5. é€‰æ‹© **Disconnect** æˆ–ç¦ç”¨è‡ªåŠ¨éƒ¨ç½²

è¿™æ ·å°±ä¼šåªå‰©ä¸‹ 4 ä¸ªæ£€æŸ¥é¡¹ï¼ˆ3 ä¸ªæ¥è‡ª deploy-vercel.yml + 1 ä¸ªæ¥è‡ª playwright.ymlï¼‰ã€‚

