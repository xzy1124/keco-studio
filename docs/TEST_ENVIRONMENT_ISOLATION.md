# Release å’Œ Main åˆ†æ”¯æµ‹è¯•ç¯å¢ƒéš”ç¦»è¯´æ˜

## ğŸ¯ éš”ç¦»æœºåˆ¶æ¦‚è¿°

Release åˆ†æ”¯ï¼ˆ`release/v0.1.0`ï¼‰å’Œ Main åˆ†æ”¯çš„æµ‹è¯•ç¯å¢ƒé€šè¿‡**ä¸‰å±‚éš”ç¦»æœºåˆ¶**å®ç°å®Œå…¨éš”ç¦»ï¼Œç¡®ä¿äº’ä¸å½±å“ã€‚

## ğŸ“‹ éš”ç¦»æœºåˆ¶è¯¦è§£

### 1. Git åˆ†æ”¯éš”ç¦»ï¼ˆä»£ç å±‚é¢ï¼‰

**åŸç†**ï¼š
- Release åˆ†æ”¯æ˜¯ Main åˆ†æ”¯åœ¨æŸä¸ªæ—¶é—´ç‚¹çš„**å¿«ç…§**
- ä¸¤ä¸ªåˆ†æ”¯çš„ä»£ç å’Œæ–‡ä»¶**å®Œå…¨ç‹¬ç«‹**
- Main åˆ†æ”¯åç»­çš„æ›´æ”¹**ä¸ä¼šè‡ªåŠ¨**åˆå¹¶åˆ° Release åˆ†æ”¯

**å®ç°**ï¼š
```bash
# Release åˆ†æ”¯åªåŒ…å«åˆ›å»ºæ—¶çš„æ–‡ä»¶
release/v0.1.0/
â””â”€â”€ supabase/migrations/  # åªåŒ…å«åˆ›å»ºæ—¶çš„ migrations

# Main åˆ†æ”¯åŒ…å«æ‰€æœ‰æ–‡ä»¶ï¼ˆåŒ…æ‹¬æ–°çš„ï¼‰
main/
â””â”€â”€ supabase/migrations/   # åŒ…å«æ‰€æœ‰ migrationsï¼ˆåŒ…æ‹¬åç»­æ–°å¢çš„ï¼‰
```

**æ•ˆæœ**ï¼š
- âœ… Main åˆ†æ”¯æ–°å¢çš„ migration æ–‡ä»¶ä¸ä¼šå‡ºç°åœ¨ Release åˆ†æ”¯
- âœ… Main åˆ†æ”¯ä¿®æ”¹è¡¨ç»“æ„ä¸ä¼šå½±å“ Release åˆ†æ”¯çš„ schema
- âœ… ä¸¤ä¸ªåˆ†æ”¯çš„ä»£ç ç‰ˆæœ¬å®Œå…¨ç‹¬ç«‹

---

### 2. CI ç¯å¢ƒéš”ç¦»ï¼ˆæ‰§è¡Œå±‚é¢ï¼‰

**åŸç†**ï¼š
- GitHub Actions ä¸ºæ¯ä¸ªåˆ†æ”¯çš„æ¯æ¬¡æ¨é€åˆ›å»º**ç‹¬ç«‹çš„è™šæ‹Ÿç¯å¢ƒ**
- æ¯ä¸ª CI è¿è¡Œåœ¨**å…¨æ–°çš„ Ubuntu å®¹å™¨**ä¸­
- å®¹å™¨ä¹‹é—´**å®Œå…¨éš”ç¦»**ï¼Œäº’ä¸å…±äº«çŠ¶æ€

**å®ç°**ï¼š
```yaml
# .github/workflows/playwright.yml
on:
  push:
    branches: [ main, master, 'release/**' ]  # æ”¯æŒå¤šä¸ªåˆ†æ”¯

jobs:
  test:
    runs-on: ubuntu-latest  # æ¯æ¬¡è¿è¡Œéƒ½æ˜¯å…¨æ–°çš„å®¹å™¨
    steps:
      - uses: actions/checkout@v4  # æ£€å‡ºå¯¹åº”åˆ†æ”¯çš„ä»£ç 
      - name: Start Supabase
        run: supabase start  # å¯åŠ¨ç‹¬ç«‹çš„æœ¬åœ° Supabase å®ä¾‹
```

**æ•ˆæœ**ï¼š
- âœ… Main åˆ†æ”¯çš„ CI è¿è¡Œåœ¨ç‹¬ç«‹å®¹å™¨ä¸­
- âœ… Release åˆ†æ”¯çš„ CI è¿è¡Œåœ¨å¦ä¸€ä¸ªç‹¬ç«‹å®¹å™¨ä¸­
- âœ… ä¸¤ä¸ª CI å¯ä»¥**åŒæ—¶è¿è¡Œ**ï¼Œäº’ä¸å¹²æ‰°

---

### 3. æœ¬åœ° Supabase å®ä¾‹éš”ç¦»ï¼ˆæ•°æ®åº“å±‚é¢ï¼‰

**åŸç†**ï¼š
- æ¯ä¸ª CI è¿è¡Œæ—¶ä¼šå¯åŠ¨**ç‹¬ç«‹çš„æœ¬åœ° Supabase å®ä¾‹**
- ä½¿ç”¨ Docker å®¹å™¨è¿è¡Œï¼Œæ¯ä¸ªå®¹å™¨æœ‰**ç‹¬ç«‹çš„æ•°æ®åº“**
- å®ä¾‹ä¹‹é—´**å®Œå…¨éš”ç¦»**ï¼Œäº’ä¸å…±äº«æ•°æ®

**å®ç°**ï¼š
```yaml
# æ¯ä¸ª CI è¿è¡Œæ—¶çš„æµç¨‹
steps:
  - name: Start Supabase
    run: supabase start  # å¯åŠ¨ç‹¬ç«‹çš„ Docker å®¹å™¨
  
  - name: Reset database with seed data
    run: supabase db reset  # åªè¿è¡Œå½“å‰åˆ†æ”¯çš„ migrations
```

**æ‰§è¡Œè¿‡ç¨‹**ï¼š
```
Main åˆ†æ”¯ CI:
â”œâ”€â”€ å¯åŠ¨æœ¬åœ° Supabase (Docker å®¹å™¨ A)
â”œâ”€â”€ è¿è¡Œ main åˆ†æ”¯çš„æ‰€æœ‰ migrations
â”œâ”€â”€ æ‰§è¡Œ Playwright æµ‹è¯•
â””â”€â”€ åœæ­¢ Supabase (å®¹å™¨é”€æ¯)

Release åˆ†æ”¯ CI:
â”œâ”€â”€ å¯åŠ¨æœ¬åœ° Supabase (Docker å®¹å™¨ B)  â† å®Œå…¨ç‹¬ç«‹çš„å®¹å™¨
â”œâ”€â”€ åªè¿è¡Œ release åˆ†æ”¯çš„ migrations   â† ä¸åŒçš„ migrations
â”œâ”€â”€ æ‰§è¡Œ Playwright æµ‹è¯•
â””â”€â”€ åœæ­¢ Supabase (å®¹å™¨é”€æ¯)
```

**æ•ˆæœ**ï¼š
- âœ… æ¯ä¸ªåˆ†æ”¯ä½¿ç”¨**ç‹¬ç«‹çš„æ•°æ®åº“å®ä¾‹**
- âœ… æ•°æ®åº“ schema ç”±å„è‡ªåˆ†æ”¯çš„ migrations å†³å®š
- âœ… Main åˆ†æ”¯çš„ schema å˜æ›´**ä¸ä¼šå½±å“** Release åˆ†æ”¯çš„æ•°æ®åº“

---

## ğŸ”„ å®Œæ•´éš”ç¦»æµç¨‹ç¤ºä¾‹

### åœºæ™¯ï¼šMain åˆ†æ”¯ä¿®æ”¹è¡¨ç»“æ„

**æ­¥éª¤ 1**ï¼šMain åˆ†æ”¯æ·»åŠ æ–°çš„ migration
```sql
-- main åˆ†æ”¯: supabase/migrations/20260108000000_add_status_to_projects.sql
ALTER TABLE projects ADD COLUMN status VARCHAR(50);
```

**æ­¥éª¤ 2**ï¼šMain åˆ†æ”¯ CI è¿è¡Œ
```
âœ… æ£€å‡º main åˆ†æ”¯ä»£ç ï¼ˆåŒ…å«æ–° migrationï¼‰
âœ… å¯åŠ¨ç‹¬ç«‹çš„æœ¬åœ° Supabase å®¹å™¨
âœ… è¿è¡Œæ‰€æœ‰ migrationsï¼ˆåŒ…æ‹¬æ–°çš„ï¼‰
âœ… æ•°æ®åº“åŒ…å« status åˆ—
âœ… æ‰§è¡Œæµ‹è¯•
âœ… å®¹å™¨é”€æ¯
```

**æ­¥éª¤ 3**ï¼šRelease åˆ†æ”¯ CI è¿è¡Œï¼ˆä¸å—å½±å“ï¼‰
```
âœ… æ£€å‡º release/v0.1.0 åˆ†æ”¯ä»£ç ï¼ˆä¸åŒ…å«æ–° migrationï¼‰
âœ… å¯åŠ¨å¦ä¸€ä¸ªç‹¬ç«‹çš„æœ¬åœ° Supabase å®¹å™¨
âœ… åªè¿è¡Œåˆ›å»ºæ—¶çš„ migrationsï¼ˆä¸åŒ…å«æ–°çš„ï¼‰
âœ… æ•°æ®åº“ä¸åŒ…å« status åˆ—ï¼ˆä¿æŒåŸæ ·ï¼‰
âœ… æ‰§è¡Œæµ‹è¯•
âœ… å®¹å™¨é”€æ¯
```

**ç»“æœ**ï¼š
- âœ… Main åˆ†æ”¯çš„ schema å˜æ›´**ä¸ä¼šå½±å“** Release åˆ†æ”¯
- âœ… ä¸¤ä¸ªåˆ†æ”¯çš„æµ‹è¯•**å®Œå…¨ç‹¬ç«‹**è¿è¡Œ
- âœ… ä¸¤ä¸ªåˆ†æ”¯çš„ CI **å¯ä»¥åŒæ—¶å…¨ç»¿**

---

## ğŸ“Š éš”ç¦»æœºåˆ¶å¯¹æ¯”è¡¨

| éš”ç¦»å±‚é¢ | éš”ç¦»æ–¹å¼ | Main åˆ†æ”¯ | Release åˆ†æ”¯ | å½±å“ |
|---------|---------|-----------|--------------|------|
| **ä»£ç éš”ç¦»** | Git åˆ†æ”¯ | åŒ…å«æ‰€æœ‰æ–‡ä»¶ | åªåŒ…å«åˆ›å»ºæ—¶çš„æ–‡ä»¶ | âœ… å®Œå…¨éš”ç¦» |
| **ç¯å¢ƒéš”ç¦»** | ç‹¬ç«‹å®¹å™¨ | ç‹¬ç«‹ Ubuntu å®¹å™¨ | ç‹¬ç«‹ Ubuntu å®¹å™¨ | âœ… å®Œå…¨éš”ç¦» |
| **æ•°æ®åº“éš”ç¦»** | ç‹¬ç«‹ Supabase | ç‹¬ç«‹ Docker å®¹å™¨ | ç‹¬ç«‹ Docker å®¹å™¨ | âœ… å®Œå…¨éš”ç¦» |
| **Schema éš”ç¦»** | Migration æ–‡ä»¶ | è¿è¡Œæ‰€æœ‰ migrations | åªè¿è¡Œåˆ›å»ºæ—¶çš„ migrations | âœ… å®Œå…¨éš”ç¦» |

---

## âœ… éªŒè¯éš”ç¦»çš„æ–¹æ³•

### æ–¹æ³• 1ï¼šæŸ¥çœ‹åˆ†æ”¯å·®å¼‚
```bash
# æŸ¥çœ‹ migrations æ–‡ä»¶å·®å¼‚
git diff main release/v0.1.0 --name-only -- supabase/migrations/
```

### æ–¹æ³• 2ï¼šæŸ¥çœ‹ CI æ—¥å¿—
- Main åˆ†æ”¯ CIï¼šæŸ¥çœ‹è¿è¡Œçš„ migrations åˆ—è¡¨
- Release åˆ†æ”¯ CIï¼šæŸ¥çœ‹è¿è¡Œçš„ migrations åˆ—è¡¨
- å¯¹æ¯”ä¸¤è€…ï¼Œç¡®è®¤å®ƒä»¬è¿è¡Œäº†ä¸åŒçš„ migrations

### æ–¹æ³• 3ï¼šåŒæ—¶è¿è¡Œ CI
- åŒæ—¶æ¨é€ Main å’Œ Release åˆ†æ”¯
- ä¸¤ä¸ª CI ä¼š**å¹¶è¡Œè¿è¡Œ**ï¼Œäº’ä¸å½±å“
- éªŒè¯ä¸¤è€…éƒ½èƒ½**ç‹¬ç«‹é€šè¿‡**

---

## ğŸ¯ æ€»ç»“

**ä¸‰å±‚éš”ç¦»æœºåˆ¶**ç¡®ä¿äº† Release å’Œ Main åˆ†æ”¯çš„æµ‹è¯•ç¯å¢ƒå®Œå…¨éš”ç¦»ï¼š

1. **Git åˆ†æ”¯éš”ç¦»**ï¼šä»£ç å’Œæ–‡ä»¶å®Œå…¨ç‹¬ç«‹
2. **CI ç¯å¢ƒéš”ç¦»**ï¼šæ¯ä¸ªåˆ†æ”¯ä½¿ç”¨ç‹¬ç«‹çš„è™šæ‹Ÿå®¹å™¨
3. **æ•°æ®åº“éš”ç¦»**ï¼šæ¯ä¸ªåˆ†æ”¯ä½¿ç”¨ç‹¬ç«‹çš„æœ¬åœ° Supabase å®ä¾‹

**ç»“æœ**ï¼š
- âœ… Main åˆ†æ”¯çš„ schema å˜æ›´ä¸ä¼šå½±å“ Release åˆ†æ”¯
- âœ… ä¸¤ä¸ªåˆ†æ”¯çš„ CI å¯ä»¥åŒæ—¶è¿è¡Œå¹¶å…¨ç»¿
- âœ… Release åˆ†æ”¯ä¿æŒç¨³å®šï¼Œä¸å— Main åˆ†æ”¯å¼€å‘å½±å“

---

**æ›´æ–°æ—¥æœŸ**: 2026-01-07  
**ç‰ˆæœ¬**: 1.0.0

